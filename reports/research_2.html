<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>research_2.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>research 2</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-DUlb-6KU.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Combination-CJczP3q7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/menu-items-CKlDAcIy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Cn3C5h2V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/select-E33nSIDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/multi-map-CMSc8wqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dropdown-menu-k3cvSs56.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-QlUG_0sW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utils-BPcfRUDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ai-model-dropdown-BuNmF2aO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/badge-DrRlgkPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/config-DOzlN8_n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNonce-CElEIK4R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-CAMtfgeb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/kbd-BEZA_QXE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/renderShortcut-Cp1zXREV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEvent-mw3fc-le.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeleteCell-yV4YK-xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lazy-NLnLn6Pi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-D-ie3mwB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/precisionRound-JPbfj2M2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-DzEPn_Ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vega-loader.browser-BJKnSXO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-CyyA9NKX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-dialog-DkIHCxse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dialog-DZWinI5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDebounce-Dc646H0x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/numbers-BrVMv_xq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/SSRProvider-3gFeNiun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/context-By5V2JVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNumberFormatter-BFHkt56k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/usePress-CqxmpITG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/input-lkQFhlrZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ImperativeModal-kroC_7ut.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cell-link-CGc-QK-U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-DZiaW65G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/links-Cd3tV5IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/state-dWjslxDZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/MarimoErrorOutput-CkZl2oHu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spinner-CM1AwwT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/strings-jhyl_xMu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/command-CgWi9W7A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/popover-ieUH9gue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useRunCells-DSf9mKXo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-zuiMeyCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-icon-DFLZbTfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mode-BAOMKXFj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/purify.es-BNe8OHFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/RenderHTML-DII6L-pL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-Ny605LgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tabs-DvBunSCS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAsyncData-BIQYiPhO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useIframeCapabilities-CRfeZulz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/error-banner-B98iBZZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/formats-Dmio8FVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useTheme-Dsb69ewj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/en-US-Cok_jNd9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isValid-BhOWABEg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/maps-B9m998ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shim-DuR5ZJNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-C81Fxkfa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/extends-BADOB1Xm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/emotion-is-prop-valid.esm-DY_d0mBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDateFormatter-DHQNk42q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-bwodJiCi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/name-cell-input-kfZkR5qv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useHotkey-VwOksnmL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-B1wJF59y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4dFcbt8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CzaCAuEN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CrvuMM2L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DZAt7AHl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Bu5OuYeo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist--8e9VGsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-SXxUBTmG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D84pVwY7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CXTAKsYC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BUfDRi87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CJIkd1DM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D5QNAo1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/apl-CAJ5Afpm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asciiarmor-B3glo3Hy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asn1-iaUkdUJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/brainfuck-C1Bv_mwK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clike-BEDWkorR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clojure-g07QXTjj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cmake-DnTqIimN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cobol-BKtG7u9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/coffeescript-D5EX_wGl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/commonlisp-QBdsjaTi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/crystal-B0kV858U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/css-lnqtDlV_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cypher-B_ciRc6O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/d-sGSUUdz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/diff-okFUO1eS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dtd-Covqp7FW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dylan-Bf_wFnkY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ecl-BON4bJzJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eiffel-CWbinnR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/elm-DKVclpIr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/erlang-D7Lapqoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/simple-mode-NsCUKpko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/factor-B2ESt4eh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/forth-CCfEYbe1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/fortran-ph1UcBiZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gas-BwHh1zIK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gherkin-a-S-92sq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/groovy-W6xB3OYy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haskell-DCE9UteQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haxe-CLcQehNU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/idl-VKcM9gU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/javascript-3wn7R2v8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mllike-BBifUJsv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/nsis-z1VCt9tx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pug-CaaLw7eE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/python-Dt99D71K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-BJLcBgU0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/objectWithoutPropertiesLoose-BhduYW5j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-DXZXojh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-C8_hvhi2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BwPQWTZk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/icons-DVWpV4I_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-missing-import-CgnlhMvv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/blob-BgGJeXvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-cell-with-ai-B5g8vtHB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-function-C7Ij9TAd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spec-D64rpvwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/focus-Bg0Cm8D6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useInstallPackage-CX-LUKF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/column-preview-CEDUFvMb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAddCell-C5hu4Wun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toggle-6a-IWcUo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/api-B8WZp3pa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globals-DlvGFwxH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/share-Cyx6Ke3B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4J1GeSh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utilities.esm-BUZA9ZNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/floating-outline-DJ1FXuVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eye-off-DNEZNQI7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/plus-VNKMcdhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/readonly-python-code-B1LohqR_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-video-camera-Bt4f7oOT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-text-KeEJTZsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-DU2hKpP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-CKcqkReK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/label-BnC8-64i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-x7Qa7Rrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textarea-faXBMy_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-ccw-Dmg0YI4-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-2-BsccpX3E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-CAATHPdC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/field-D6TVJZGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/switch-DBfU9QHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useBoolean-Do2iSPXV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeepCompareMemoize-DVzR9zu0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/LazyAnyLanguageCodeMirror-C5EeHVjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-BfF9hgo8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/prop-types-DVt2dPhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/es-Bve1w9dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/VisuallyHidden-BhVlvbgE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globe-DW6c4--m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/send-DjnZs47z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-cw-z53rVhjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/settings-Dt7V2Blo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/triangle-alert-DoSv9yQr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/bundle.esm-CC-LjhS-.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-CYOH-TAt.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "research_2.py",
            "mode": "read",
            "version": "0.17.8",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 17, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "dark"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "mo.md(r\"\"\"\n*This notebook is a continued version of `research.py` notebook. Please read that first. You can open the `research.html` file to do that too.*\n\"\"\")", "code_hash": "5d237b7cfadece458a4716ebc3f71214", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"\n# The Problem\n\"\"\")", "code_hash": "f34a0728b0651c144f48ecec3fd600f4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\nAt the time of writing this, I have already trained the model, developed the front-end and the web app. Now, I have realized that putting 33 feature columns as input is a bad call. This will be a fraustrating experience for any user. So, in this notebook, I am going to reduce some features and feature-enginner if necessary.\n\"\"\")", "code_hash": "2a37921db0b6c7279aaf3f74927049cf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"\n**Importing modules**\n\"\"\")", "code_hash": "63f00bb2d3a63f141497c868dada6a71", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "from sklearn.ensemble import RandomForestClassifier,VotingClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nfrom xgboost import XGBClassifier\n\nfrom sklearn.decomposition import PCA\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA\n\nfrom sklearn.model_selection import train_test_split,learning_curve,RandomizedSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.metrics import classification_report\n\nfrom imblearn.over_sampling import SMOTE\nfrom imblearn.pipeline import Pipeline\n\nimport numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns", "code_hash": "d18368b3c8c11ec7143da17b4c1fb89c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Basic Preprocessing\n\"\"\")", "code_hash": "d7c745dd700605b95bc463a65e14c6d7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "mo.md(r\"\"\"\nImporting the dataset\n\"\"\")", "code_hash": "4c6311ad2d43dd209accd9c47ede6583", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "df_raw = pd.read_csv(\"Datasets/SDSS_DR18.csv\")\ndf_raw.columns", "code_hash": "dc5718c40dd484083a2e55f5269c53da", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.md(r\"\"\"\nDropping the identifier columns which may lead to data leakage\n\"\"\")", "code_hash": "7ecb7ce8aa306ac8b7b5cb376cb997e2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "df_raw_1 = df_raw.drop(columns=['objid', 'specobjid', 'run', 'rerun', 'camcol', 'field', 'plate', 'mjd', 'fiberid'])\ndf_raw_1.columns", "code_hash": "1702d982fb9bd1b2459f155b574a8725", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(r\"\"\"\nIdentifying and mapping the classes\n\"\"\")", "code_hash": "1c2c3e0e7a9c0052b918b87d02c706bf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "print(df_raw_1['class'].value_counts())\ndf_1 = df_raw_1.copy()", "code_hash": "679e0900692ca26595eca992e375d3ec", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "df_1[\"class\"] = df_1[\"class\"].map({\n  \"GALAXY\":0,\n  \"STAR\":1,\n  \"QSO\":2\n})\ndf_1[\"class\"].head(10)", "code_hash": "45c97e4d053625ef59ecf53e626c64ab", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Feature Reduction and Engineering\n\"\"\")", "code_hash": "867737bb1757b51c8c6fee6f2354b2c4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nWHF", "name": "_"}, {"code": "mo.md(r\"\"\"\nDropping all raw fluxes, all concentration indices, all radii, all error terms, and all duplicate magnitudes. I have copied a subset of features from `df_1` to `df_2`. This subset excludes all of those features.\n\"\"\")", "code_hash": "27ea1515b81724699d7f65283f600db8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "df_2 = df_1[[\"ra\",\"dec\",\"redshift\",\"u\",\"g\",\"r\",\"i\",\"z\",\"psfMag_r\",\"class\"]].copy()", "code_hash": "d43046294d2bd0d416a2d07f53f9c7f3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(r\"\"\"\nFeature engineering color contrast columns\n\"\"\")", "code_hash": "b192d709708347be98d04a1dfe346f0d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "df_2[\"u_g_color\"] = df_2[\"u\"] - df_2[\"g\"]\ndf_2[\"g_r_color\"] = df_2[\"g\"] - df_2[\"r\"]\ndf_2[\"r_i_color\"] = df_2[\"r\"] - df_2[\"i\"]\ndf_2[\"i_z_color\"] = df_2[\"i\"] - df_2[\"z\"]", "code_hash": "c5f5c9ab8be3050340571333923d0526", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"\nDropping the raw color features\n\"\"\")", "code_hash": "ecbe7e47581d9dcb34f4225aab447529", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "df_2.head(2)", "code_hash": "d48926ae88420c53b289b4c37127f0c5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "df_2_1 = df_2.drop(columns=['u', 'g', 'r', 'i', 'z'])", "code_hash": "4d820a599439521956270b4b4dc31e9a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "df_2_1.head(2)", "code_hash": "87b646e2763cdda0b9b4b6b3aa106318", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(r\"\"\"\nMoving the class column to the end\n\"\"\")", "code_hash": "dd35a6668b7b038486878541cc1c207f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "popped_class = df_2_1.pop('class')\ndf_2_1.insert(len(df_2_1.columns), 'class', popped_class)", "code_hash": "7dd794c9e420f291dad222494ada112c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "df_2_1.head(3)", "code_hash": "5d53a76083f6ddefb264a129044bc196", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "mo.md(r\"\"\"\nCopying `df_2` into the main dataframe and separating feature and target columns\n\"\"\")", "code_hash": "9ceb21bd01985d3d874d7811833b7b06", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aLJB", "name": "_"}, {"code": "df = df_2_1.copy()\nx = df.iloc[:, :-1].to_numpy()\ny = df.iloc[:, -1].to_numpy()\nfeature_columns = df.columns[:-1]\nfeature_columns", "code_hash": "257cb99fc523cbfbbdfb8da6ace6c703", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"\n## ML Preprocessing, Model training, Evaluation\n\"\"\")", "code_hash": "e43c72349330f59f301ae331278bcc9b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "mo.md(r\"\"\"\nPerforming train-test split\n\"\"\")", "code_hash": "3ff3bba03d9e38b882c05d15d67fe362", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "AjVT", "name": "_"}, {"code": "x_train,x_test,y_train,y_test = train_test_split(\n  x,y,test_size=2/10,random_state=120,shuffle=True,stratify=y)", "code_hash": "924a6303e6926af974f80d9da67af947", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(r\"\"\"\nDefining the pipeline and the model\n\"\"\")", "code_hash": "755bb675c96145883b3c5d5cf6a2bcfb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NCOB", "name": "_"}, {"code": "# RF, SVC, LR, XGB\nrf_model = RandomForestClassifier(random_state=40)\nsvc_model = SVC(random_state=41)\nlr_model = LogisticRegression(random_state=42,max_iter=10_000)\nxgb_model = XGBClassifier(random_state=43)\n\npca = PCA(random_state=44)\nlda = LDA(n_components=2)\n\npipe = Pipeline([\n  (\"impute\",SimpleImputer(strategy=\"median\")),\n  (\"scale\",StandardScaler()),\n  (\"smote\",SMOTE(random_state=101)),\n  (\"dimen\",pca),\n  (\"model\",rf_model)\n])", "code_hash": "74ad84d806cd1467ab08a8569f1f0f30", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"\nPerforming Randomized Search CV\n\"\"\")", "code_hash": "e45d9944970dc0fcf716f38da1894cfc", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "param_list = [\n  { # Random Forest, PCA On\n    \"model\": [rf_model],\"model__n_estimators\":np.arange(150,650,100),\n    \"model__max_depth\":np.arange(7,14,2), \"dimen\" : [pca], \"dimen__n_components\": np.arange(5,8,1)\n  },\n\n  # { # SVC, No dimen. reduction\n  #   \"model\": [svc_model], \"model__C\":[0.01,0.1,1,10], \"model__kernel\":[\"rbf\"], \"model__gamma\":[0.01,0.1,1,10],\n  #   \"dimen\":[\"passthrough\"]\n  # },\n\n  { # Logistic Regression, No dimen. reduction, l1 penalty, `saga` solver\n    \"model\": [lr_model], \"model__C\": [0.01,0.1,1,10], \"model__penalty\":[\"l1\"], \"model__solver\":[\"saga\"],\n    \"dimen\": [\"passthrough\"]\n  },\n  { # Logistic Regression, No dimen. reduction, l2 penalty, `lbfgs` solver\n    \"model\": [lr_model], \"model__C\": [0.01,0.1,1,10], \"model__penalty\":[\"l2\"], \"model__solver\":[\"lbfgs\"],\n    \"dimen\": [\"passthrough\"]\n  },\n  { # XGBoost, PCA On\n    \"dimen\": [pca], \"dimen__n_components\": np.arange(5,8,1),\n    \"model\": [xgb_model], \"model__n_estimators\" : np.linspace(500,1100,3,dtype=int),\"model__learning_rate\": [0.01,0.1], \"model__max_depth\":np.arange(7,14,3)\n  },\n  { # XGBoost, LDA On\n    \"dimen\": [lda],\n    \"model\": [xgb_model], \"model__n_estimators\" : [500,700,900],\"model__learning_rate\": [0.01,0.1], \"model__max_depth\":np.arange(7,14,3)\n  },\n  { # XGBoost, No dimen. reduction\n    \"dimen\": [\"passthrough\"],\n    \"model\": [xgb_model], \"model__n_estimators\" : [500,700,900],\"model__learning_rate\": [0.01,0.1], \"model__max_depth\":np.arange(7,14,3)\n  }\n]\n\nrscv = RandomizedSearchCV(\n  estimator=pipe,param_distributions=param_list,n_iter=8,cv=5,n_jobs=-1,random_state=50,refit=True\n)\n\nrscv.fit(x_train,y_train)\nestimator = rscv.best_estimator_\nscore = rscv.best_score_\nconfig = rscv.best_params_\nprint(f\"Best Configuration:\\n{config}\")\nprint(f\"Best Score = {score}\")", "code_hash": "6f383f48dae629ac231006b8687e6cfe", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(r\"\"\"\nNow, let's calculate the **Classification Report**\n\"\"\")", "code_hash": "cc14a4b4bf62accacc751a9661f6adef", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dNNg", "name": "_"}, {"code": "y_true = y_test\ny_pred = rscv.predict(x_test)\nprint(classification_report(y_true=y_true,y_pred=y_pred))", "code_hash": "2b780d1e7c3e7b5bfbd0dafd4fb68ec7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "mo.md(r\"\"\"\nAs we can see, the overall accuracy decreased about 1% from before. But it is a huge win considering the simplicity we have successfully added by performing the feature reduction.\n\"\"\")", "code_hash": "336624f20bec4ad70417b0342e08760c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wlCL", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Summary\n\"\"\")", "code_hash": "fbee05903c979c0a5eb3bc3523ece590", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "kqZH", "name": "_"}, {"code": "mo.md(r\"\"\"\nIn this notebook, we have explored how we can make the model suitable for user usage by reducing the number of features. We have seen that it has made the model a lot simplier by only sacrificing 1% accuracy.\n\nWe will use the code from this notebook to write `fit.py` from the ground up.\n\"\"\")", "code_hash": "98d7e193e9b2e584aca895f8f228ac9f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wAgl", "name": "_"}, {"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "5d237b7cfadece458a4716ebc3f71214", "console": [], "id": "Hbol", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cem\u003EThis notebook is a continued version of \u003Ccode\u003Eresearch.py\u003C/code\u003E notebook. Please read that first. You can open the \u003Ccode\u003Eresearch.html\u003C/code\u003E file to do that too.\u003C/em\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f34a0728b0651c144f48ecec3fd600f4", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"the-problem\"\u003EThe Problem\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2a37921db0b6c7279aaf3f74927049cf", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EAt the time of writing this, I have already trained the model, developed the front-end and the web app. Now, I have realized that putting 33 feature columns as input is a bad call. This will be a fraustrating experience for any user. So, in this notebook, I am going to reduce some features and feature-enginner if necessary.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "63f00bb2d3a63f141497c868dada6a71", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EImporting modules\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d18368b3c8c11ec7143da17b4c1fb89c", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d7c745dd700605b95bc463a65e14c6d7", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"basic-preprocessing\"\u003EBasic Preprocessing\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4c6311ad2d43dd209accd9c47ede6583", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EImporting the dataset\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "dc5718c40dd484083a2e55f5269c53da", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cpre style='font-size: 12px'\u003EIndex([\u0026#x27;objid\u0026#x27;, \u0026#x27;specobjid\u0026#x27;, \u0026#x27;ra\u0026#x27;, \u0026#x27;dec\u0026#x27;, \u0026#x27;u\u0026#x27;, \u0026#x27;g\u0026#x27;, \u0026#x27;r\u0026#x27;, \u0026#x27;i\u0026#x27;, \u0026#x27;z\u0026#x27;, \u0026#x27;run\u0026#x27;,\n       \u0026#x27;rerun\u0026#x27;, \u0026#x27;camcol\u0026#x27;, \u0026#x27;field\u0026#x27;, \u0026#x27;plate\u0026#x27;, \u0026#x27;mjd\u0026#x27;, \u0026#x27;fiberid\u0026#x27;, \u0026#x27;petroRad_u\u0026#x27;,\n       \u0026#x27;petroRad_g\u0026#x27;, \u0026#x27;petroRad_i\u0026#x27;, \u0026#x27;petroRad_r\u0026#x27;, \u0026#x27;petroRad_z\u0026#x27;, \u0026#x27;petroFlux_u\u0026#x27;,\n       \u0026#x27;petroFlux_g\u0026#x27;, \u0026#x27;petroFlux_i\u0026#x27;, \u0026#x27;petroFlux_r\u0026#x27;, \u0026#x27;petroFlux_z\u0026#x27;,\n       \u0026#x27;petroR50_u\u0026#x27;, \u0026#x27;petroR50_g\u0026#x27;, \u0026#x27;petroR50_i\u0026#x27;, \u0026#x27;petroR50_r\u0026#x27;, \u0026#x27;petroR50_z\u0026#x27;,\n       \u0026#x27;psfMag_u\u0026#x27;, \u0026#x27;psfMag_r\u0026#x27;, \u0026#x27;psfMag_g\u0026#x27;, \u0026#x27;psfMag_i\u0026#x27;, \u0026#x27;psfMag_z\u0026#x27;, \u0026#x27;expAB_u\u0026#x27;,\n       \u0026#x27;expAB_g\u0026#x27;, \u0026#x27;expAB_r\u0026#x27;, \u0026#x27;expAB_i\u0026#x27;, \u0026#x27;expAB_z\u0026#x27;, \u0026#x27;redshift\u0026#x27;, \u0026#x27;class\u0026#x27;],\n      dtype=\u0026#x27;object\u0026#x27;)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "7ecb7ce8aa306ac8b7b5cb376cb997e2", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDropping the identifier columns which may lead to data leakage\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1702d982fb9bd1b2459f155b574a8725", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cpre style='font-size: 12px'\u003EIndex([\u0026#x27;ra\u0026#x27;, \u0026#x27;dec\u0026#x27;, \u0026#x27;u\u0026#x27;, \u0026#x27;g\u0026#x27;, \u0026#x27;r\u0026#x27;, \u0026#x27;i\u0026#x27;, \u0026#x27;z\u0026#x27;, \u0026#x27;petroRad_u\u0026#x27;, \u0026#x27;petroRad_g\u0026#x27;,\n       \u0026#x27;petroRad_i\u0026#x27;, \u0026#x27;petroRad_r\u0026#x27;, \u0026#x27;petroRad_z\u0026#x27;, \u0026#x27;petroFlux_u\u0026#x27;, \u0026#x27;petroFlux_g\u0026#x27;,\n       \u0026#x27;petroFlux_i\u0026#x27;, \u0026#x27;petroFlux_r\u0026#x27;, \u0026#x27;petroFlux_z\u0026#x27;, \u0026#x27;petroR50_u\u0026#x27;, \u0026#x27;petroR50_g\u0026#x27;,\n       \u0026#x27;petroR50_i\u0026#x27;, \u0026#x27;petroR50_r\u0026#x27;, \u0026#x27;petroR50_z\u0026#x27;, \u0026#x27;psfMag_u\u0026#x27;, \u0026#x27;psfMag_r\u0026#x27;,\n       \u0026#x27;psfMag_g\u0026#x27;, \u0026#x27;psfMag_i\u0026#x27;, \u0026#x27;psfMag_z\u0026#x27;, \u0026#x27;expAB_u\u0026#x27;, \u0026#x27;expAB_g\u0026#x27;, \u0026#x27;expAB_r\u0026#x27;,\n       \u0026#x27;expAB_i\u0026#x27;, \u0026#x27;expAB_z\u0026#x27;, \u0026#x27;redshift\u0026#x27;, \u0026#x27;class\u0026#x27;],\n      dtype=\u0026#x27;object\u0026#x27;)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "1c2c3e0e7a9c0052b918b87d02c706bf", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EIdentifying and mapping the classes\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "679e0900692ca26595eca992e375d3ec", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "class\nGALAXY    52343\nSTAR      37232\nQSO       10425\nName: count, dtype: int64\n", "type": "stream"}], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "45c97e4d053625ef59ecf53e626c64ab", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='Hstk-0' random-id='a79b2970-0bab-f013-1149-e9197dfec54c'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1}]\u0026quot;' data-total-rows='10' data-total-columns='1' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;class\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "867737bb1757b51c8c6fee6f2354b2c4", "console": [], "id": "nWHF", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"feature-reduction-and-engineering\"\u003EFeature Reduction and Engineering\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "27ea1515b81724699d7f65283f600db8", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDropping all raw fluxes, all concentration indices, all radii, all error terms, and all duplicate magnitudes. I have copied a subset of features from \u003Ccode\u003Edf_1\u003C/code\u003E to \u003Ccode\u003Edf_2\u003C/code\u003E. This subset excludes all of those features.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d43046294d2bd0d416a2d07f53f9c7f3", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b192d709708347be98d04a1dfe346f0d", "console": [], "id": "ROlb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EFeature engineering color contrast columns\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c5f5c9ab8be3050340571333923d0526", "console": [], "id": "qnkX", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ecbe7e47581d9dcb34f4225aab447529", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDropping the raw color features\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d48926ae88420c53b289b4c37127f0c5", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='Vxnm-0' random-id='9eb4aed4-af0e-b29a-ce82-f649d7243e0c'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:184.9508694,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.733067869,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:0.04169106,\u0026#92;\u0026quot;u\u0026#92;\u0026quot;:18.87062,\u0026#92;\u0026quot;g\u0026#92;\u0026quot;:17.59612,\u0026#92;\u0026quot;r\u0026#92;\u0026quot;:17.11245,\u0026#92;\u0026quot;i\u0026#92;\u0026quot;:16.83899,\u0026#92;\u0026quot;z\u0026#92;\u0026quot;:16.70908,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:19.50324,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:1.2745,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:0.48367,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:0.27346,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.12991},{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:185.7292013,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.679703907,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:-0.000814368,\u0026#92;\u0026quot;u\u0026#92;\u0026quot;:19.5956,\u0026#92;\u0026quot;g\u0026#92;\u0026quot;:19.92153,\u0026#92;\u0026quot;r\u0026#92;\u0026quot;:20.34448,\u0026#92;\u0026quot;i\u0026#92;\u0026quot;:20.66213,\u0026#92;\u0026quot;z\u0026#92;\u0026quot;:20.59599,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:20.34491,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:-0.32593,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:-0.42295,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:-0.31765,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.06614}]\u0026quot;' data-total-rows='2' data-total-columns='14' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;ra\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;dec\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;redshift\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;u\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;g\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;r\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;i\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;z\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;psfMag_r\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;class\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;u_g_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;g_r_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;r_i_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;i_z_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "4d820a599439521956270b4b4dc31e9a", "console": [], "id": "DnEU", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "87b646e2763cdda0b9b4b6b3aa106318", "console": [], "id": "ulZA", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='ulZA-0' random-id='77f051f9-bbf6-72d0-48b3-3ca4ed3ef7a7'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:184.9508694,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.733067869,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:0.04169106,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:19.50324,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:1.2745,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:0.48367,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:0.27346,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.12991},{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:185.7292013,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.679703907,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:-0.000814368,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:20.34491,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:-0.32593,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:-0.42295,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:-0.31765,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.06614}]\u0026quot;' data-total-rows='2' data-total-columns='9' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;ra\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;dec\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;redshift\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;psfMag_r\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;class\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;u_g_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;g_r_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;r_i_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;i_z_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "dd35a6668b7b038486878541cc1c207f", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EMoving the class column to the end\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7dd794c9e420f291dad222494ada112c", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "5d53a76083f6ddefb264a129044bc196", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='ZBYS-0' random-id='ba8e043a-e009-a048-8af6-b9c206b794d7'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:184.9508694,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.733067869,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:0.04169106,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:19.50324,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:1.2745,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:0.48367,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:0.27346,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.12991,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:185.7292013,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.679703907,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:-0.000814368,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:20.34491,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:-0.32593,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:-0.42295,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:-0.31765,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.06614,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;ra\u0026#92;\u0026quot;:185.68769,\u0026#92;\u0026quot;dec\u0026#92;\u0026quot;:0.823480387,\u0026#92;\u0026quot;redshift\u0026#92;\u0026quot;:0.1130687,\u0026#92;\u0026quot;psfMag_r\u0026#92;\u0026quot;:18.54832,\u0026#92;\u0026quot;u_g_color\u0026#92;\u0026quot;:1.3853,\u0026#92;\u0026quot;g_r_color\u0026#92;\u0026quot;:0.78298,\u0026#92;\u0026quot;r_i_color\u0026#92;\u0026quot;:0.44434,\u0026#92;\u0026quot;i_z_color\u0026#92;\u0026quot;:0.2983,\u0026#92;\u0026quot;class\u0026#92;\u0026quot;:0}]\u0026quot;' data-total-rows='3' data-total-columns='9' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;ra\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;dec\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;redshift\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;psfMag_r\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;u_g_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;g_r_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;r_i_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;i_z_color\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;class\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "9ceb21bd01985d3d874d7811833b7b06", "console": [], "id": "aLJB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ECopying \u003Ccode\u003Edf_2\u003C/code\u003E into the main dataframe and separating feature and target columns\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "257cb99fc523cbfbbdfb8da6ace6c703", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "\u003Cpre style='font-size: 12px'\u003EIndex([\u0026#x27;ra\u0026#x27;, \u0026#x27;dec\u0026#x27;, \u0026#x27;redshift\u0026#x27;, \u0026#x27;psfMag_r\u0026#x27;, \u0026#x27;u_g_color\u0026#x27;, \u0026#x27;g_r_color\u0026#x27;,\n       \u0026#x27;r_i_color\u0026#x27;, \u0026#x27;i_z_color\u0026#x27;],\n      dtype=\u0026#x27;object\u0026#x27;)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "e43c72349330f59f301ae331278bcc9b", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"ml-preprocessing-model-training-evaluation\"\u003EML Preprocessing, Model training, Evaluation\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3ff3bba03d9e38b882c05d15d67fe362", "console": [], "id": "AjVT", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EPerforming train-test split\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "924a6303e6926af974f80d9da67af947", "console": [], "id": "pHFh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "755bb675c96145883b3c5d5cf6a2bcfb", "console": [], "id": "NCOB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EDefining the pipeline and the model\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "74ad84d806cd1467ab08a8569f1f0f30", "console": [], "id": "aqbW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e45d9944970dc0fcf716f38da1894cfc", "console": [], "id": "TRpd", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EPerforming Randomized Search CV\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6f383f48dae629ac231006b8687e6cfe", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/joblib/externals/loky/process_executor.py:782: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.\n  warnings.warn(\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "Best Configuration:\n{'model__solver': 'saga', 'model__penalty': 'l1', 'model__C': 10, 'model': LogisticRegression(max_iter=10000, random_state=42), 'dimen': 'passthrough'}\nBest Score = 0.9758125\n", "type": "stream"}], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cc14a4b4bf62accacc751a9661f6adef", "console": [], "id": "dNNg", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENow, let's calculate the \u003Cstrong\u003EClassification Report\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2b780d1e7c3e7b5bfbd0dafd4fb68ec7", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "              precision    recall  f1-score   support\n\n           0       0.99      0.96      0.98     10469\n           1       0.96      1.00      0.98      7446\n           2       0.96      0.96      0.96      2085\n\n    accuracy                           0.97     20000\n   macro avg       0.97      0.97      0.97     20000\nweighted avg       0.98      0.97      0.97     20000\n\n", "type": "stream"}], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "336624f20bec4ad70417b0342e08760c", "console": [], "id": "wlCL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EAs we can see, the overall accuracy decreased about 1% from before. But it is a huge win considering the simplicity we have successfully added by performing the feature reduction.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "fbee05903c979c0a5eb3bc3523ece590", "console": [], "id": "kqZH", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"summary\"\u003ESummary\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "98d7e193e9b2e584aca895f8f228ac9f", "console": [], "id": "wAgl", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EIn this notebook, we have explored how we can make the model suitable for user usage by reducing the number of features. We have seen that it has made the model a lot simplier by only sacrificing 1% accuracy.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe will use the code from this notebook to write \u003Ccode\u003Efit.py\u003C/code\u003E from the ground up.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "rEll", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.8%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20*This%20notebook%20is%20a%20continued%20version%20of%20%60research.py%60%20notebook.%20Please%20read%20that%20first.%20You%20can%20open%20the%20%60research.html%60%20file%20to%20do%20that%20too.*%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20The%20Problem%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20At%20the%20time%20of%20writing%20this%2C%20I%20have%20already%20trained%20the%20model%2C%20developed%20the%20front-end%20and%20the%20web%20app.%20Now%2C%20I%20have%20realized%20that%20putting%2033%20feature%20columns%20as%20input%20is%20a%20bad%20call.%20This%20will%20be%20a%20fraustrating%20experience%20for%20any%20user.%20So%2C%20in%20this%20notebook%2C%20I%20am%20going%20to%20reduce%20some%20features%20and%20feature-enginner%20if%20necessary.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20**Importing%20modules**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.ensemble%20import%20RandomForestClassifier%2CVotingClassifier%0A%20%20%20%20from%20sklearn.svm%20import%20SVC%0A%20%20%20%20from%20sklearn.linear_model%20import%20LogisticRegression%0A%20%20%20%20from%20xgboost%20import%20XGBClassifier%0A%0A%20%20%20%20from%20sklearn.decomposition%20import%20PCA%0A%20%20%20%20from%20sklearn.discriminant_analysis%20import%20LinearDiscriminantAnalysis%20as%20LDA%0A%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%2Clearning_curve%2CRandomizedSearchCV%0A%20%20%20%20from%20sklearn.preprocessing%20import%20StandardScaler%0A%20%20%20%20from%20sklearn.impute%20import%20SimpleImputer%0A%20%20%20%20from%20sklearn.metrics%20import%20classification_report%0A%0A%20%20%20%20from%20imblearn.over_sampling%20import%20SMOTE%0A%20%20%20%20from%20imblearn.pipeline%20import%20Pipeline%0A%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20from%20matplotlib%20import%20pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20LDA%2C%0A%20%20%20%20%20%20%20%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20PCA%2C%0A%20%20%20%20%20%20%20%20Pipeline%2C%0A%20%20%20%20%20%20%20%20RandomForestClassifier%2C%0A%20%20%20%20%20%20%20%20RandomizedSearchCV%2C%0A%20%20%20%20%20%20%20%20SMOTE%2C%0A%20%20%20%20%20%20%20%20SVC%2C%0A%20%20%20%20%20%20%20%20SimpleImputer%2C%0A%20%20%20%20%20%20%20%20StandardScaler%2C%0A%20%20%20%20%20%20%20%20XGBClassifier%2C%0A%20%20%20%20%20%20%20%20classification_report%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20train_test_split%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Basic%20Preprocessing%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Importing%20the%20dataset%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20df_raw%20%3D%20pd.read_csv(%22Datasets%2FSDSS_DR18.csv%22)%0A%20%20%20%20df_raw.columns%0A%20%20%20%20return%20(df_raw%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Dropping%20the%20identifier%20columns%20which%20may%20lead%20to%20data%20leakage%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_raw)%3A%0A%20%20%20%20df_raw_1%20%3D%20df_raw.drop(columns%3D%5B'objid'%2C%20'specobjid'%2C%20'run'%2C%20'rerun'%2C%20'camcol'%2C%20'field'%2C%20'plate'%2C%20'mjd'%2C%20'fiberid'%5D)%0A%20%20%20%20df_raw_1.columns%0A%20%20%20%20return%20(df_raw_1%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Identifying%20and%20mapping%20the%20classes%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_raw_1)%3A%0A%20%20%20%20print(df_raw_1%5B'class'%5D.value_counts())%0A%20%20%20%20df_1%20%3D%20df_raw_1.copy()%0A%20%20%20%20return%20(df_1%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_1)%3A%0A%20%20%20%20df_1%5B%22class%22%5D%20%3D%20df_1%5B%22class%22%5D.map(%7B%0A%20%20%20%20%20%20%22GALAXY%22%3A0%2C%0A%20%20%20%20%20%20%22STAR%22%3A1%2C%0A%20%20%20%20%20%20%22QSO%22%3A2%0A%20%20%20%20%7D)%0A%20%20%20%20df_1%5B%22class%22%5D.head(10)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Feature%20Reduction%20and%20Engineering%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Dropping%20all%20raw%20fluxes%2C%20all%20concentration%20indices%2C%20all%20radii%2C%20all%20error%20terms%2C%20and%20all%20duplicate%20magnitudes.%20I%20have%20copied%20a%20subset%20of%20features%20from%20%60df_1%60%20to%20%60df_2%60.%20This%20subset%20excludes%20all%20of%20those%20features.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_1)%3A%0A%20%20%20%20df_2%20%3D%20df_1%5B%5B%22ra%22%2C%22dec%22%2C%22redshift%22%2C%22u%22%2C%22g%22%2C%22r%22%2C%22i%22%2C%22z%22%2C%22psfMag_r%22%2C%22class%22%5D%5D.copy()%0A%20%20%20%20return%20(df_2%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Feature%20engineering%20color%20contrast%20columns%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2)%3A%0A%20%20%20%20df_2%5B%22u_g_color%22%5D%20%3D%20df_2%5B%22u%22%5D%20-%20df_2%5B%22g%22%5D%0A%20%20%20%20df_2%5B%22g_r_color%22%5D%20%3D%20df_2%5B%22g%22%5D%20-%20df_2%5B%22r%22%5D%0A%20%20%20%20df_2%5B%22r_i_color%22%5D%20%3D%20df_2%5B%22r%22%5D%20-%20df_2%5B%22i%22%5D%0A%20%20%20%20df_2%5B%22i_z_color%22%5D%20%3D%20df_2%5B%22i%22%5D%20-%20df_2%5B%22z%22%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Dropping%20the%20raw%20color%20features%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2)%3A%0A%20%20%20%20df_2.head(2)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2)%3A%0A%20%20%20%20df_2_1%20%3D%20df_2.drop(columns%3D%5B'u'%2C%20'g'%2C%20'r'%2C%20'i'%2C%20'z'%5D)%0A%20%20%20%20return%20(df_2_1%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_2_1)%3A%0A%20%20%20%20df_2_1.head(2)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Moving%20the%20class%20column%20to%20the%20end%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2_1)%3A%0A%20%20%20%20popped_class%20%3D%20df_2_1.pop('class')%0A%20%20%20%20df_2_1.insert(len(df_2_1.columns)%2C%20'class'%2C%20popped_class)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2_1)%3A%0A%20%20%20%20df_2_1.head(3)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Copying%20%60df_2%60%20into%20the%20main%20dataframe%20and%20separating%20feature%20and%20target%20columns%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_2_1)%3A%0A%20%20%20%20df%20%3D%20df_2_1.copy()%0A%20%20%20%20x%20%3D%20df.iloc%5B%3A%2C%20%3A-1%5D.to_numpy()%0A%20%20%20%20y%20%3D%20df.iloc%5B%3A%2C%20-1%5D.to_numpy()%0A%20%20%20%20feature_columns%20%3D%20df.columns%5B%3A-1%5D%0A%20%20%20%20feature_columns%0A%20%20%20%20return%20x%2C%20y%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20ML%20Preprocessing%2C%20Model%20training%2C%20Evaluation%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Performing%20train-test%20split%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(train_test_split%2C%20x%2C%20y)%3A%0A%20%20%20%20x_train%2Cx_test%2Cy_train%2Cy_test%20%3D%20train_test_split(%0A%20%20%20%20%20%20x%2Cy%2Ctest_size%3D2%2F10%2Crandom_state%3D120%2Cshuffle%3DTrue%2Cstratify%3Dy)%0A%20%20%20%20return%20x_test%2C%20x_train%2C%20y_test%2C%20y_train%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Defining%20the%20pipeline%20and%20the%20model%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20LDA%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20PCA%2C%0A%20%20%20%20Pipeline%2C%0A%20%20%20%20RandomForestClassifier%2C%0A%20%20%20%20SMOTE%2C%0A%20%20%20%20SVC%2C%0A%20%20%20%20SimpleImputer%2C%0A%20%20%20%20StandardScaler%2C%0A%20%20%20%20XGBClassifier%2C%0A)%3A%0A%20%20%20%20%23%20RF%2C%20SVC%2C%20LR%2C%20XGB%0A%20%20%20%20rf_model%20%3D%20RandomForestClassifier(random_state%3D40)%0A%20%20%20%20svc_model%20%3D%20SVC(random_state%3D41)%0A%20%20%20%20lr_model%20%3D%20LogisticRegression(random_state%3D42%2Cmax_iter%3D10_000)%0A%20%20%20%20xgb_model%20%3D%20XGBClassifier(random_state%3D43)%0A%0A%20%20%20%20pca%20%3D%20PCA(random_state%3D44)%0A%20%20%20%20lda%20%3D%20LDA(n_components%3D2)%0A%0A%20%20%20%20pipe%20%3D%20Pipeline(%5B%0A%20%20%20%20%20%20(%22impute%22%2CSimpleImputer(strategy%3D%22median%22))%2C%0A%20%20%20%20%20%20(%22scale%22%2CStandardScaler())%2C%0A%20%20%20%20%20%20(%22smote%22%2CSMOTE(random_state%3D101))%2C%0A%20%20%20%20%20%20(%22dimen%22%2Cpca)%2C%0A%20%20%20%20%20%20(%22model%22%2Crf_model)%0A%20%20%20%20%5D)%0A%20%20%20%20return%20lda%2C%20lr_model%2C%20pca%2C%20pipe%2C%20rf_model%2C%20xgb_model%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Performing%20Randomized%20Search%20CV%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20RandomizedSearchCV%2C%0A%20%20%20%20lda%2C%0A%20%20%20%20lr_model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pca%2C%0A%20%20%20%20pipe%2C%0A%20%20%20%20rf_model%2C%0A%20%20%20%20x_train%2C%0A%20%20%20%20xgb_model%2C%0A%20%20%20%20y_train%2C%0A)%3A%0A%20%20%20%20param_list%20%3D%20%5B%0A%20%20%20%20%20%20%7B%20%23%20Random%20Forest%2C%20PCA%20On%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Brf_model%5D%2C%22model__n_estimators%22%3Anp.arange(150%2C650%2C100)%2C%0A%20%20%20%20%20%20%20%20%22model__max_depth%22%3Anp.arange(7%2C14%2C2)%2C%20%22dimen%22%20%3A%20%5Bpca%5D%2C%20%22dimen__n_components%22%3A%20np.arange(5%2C8%2C1)%0A%20%20%20%20%20%20%7D%2C%0A%0A%20%20%20%20%20%20%23%20%7B%20%23%20SVC%2C%20No%20dimen.%20reduction%0A%20%20%20%20%20%20%23%20%20%20%22model%22%3A%20%5Bsvc_model%5D%2C%20%22model__C%22%3A%5B0.01%2C0.1%2C1%2C10%5D%2C%20%22model__kernel%22%3A%5B%22rbf%22%5D%2C%20%22model__gamma%22%3A%5B0.01%2C0.1%2C1%2C10%5D%2C%0A%20%20%20%20%20%20%23%20%20%20%22dimen%22%3A%5B%22passthrough%22%5D%0A%20%20%20%20%20%20%23%20%7D%2C%0A%0A%20%20%20%20%20%20%7B%20%23%20Logistic%20Regression%2C%20No%20dimen.%20reduction%2C%20l1%20penalty%2C%20%60saga%60%20solver%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Blr_model%5D%2C%20%22model__C%22%3A%20%5B0.01%2C0.1%2C1%2C10%5D%2C%20%22model__penalty%22%3A%5B%22l1%22%5D%2C%20%22model__solver%22%3A%5B%22saga%22%5D%2C%0A%20%20%20%20%20%20%20%20%22dimen%22%3A%20%5B%22passthrough%22%5D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20%23%20Logistic%20Regression%2C%20No%20dimen.%20reduction%2C%20l2%20penalty%2C%20%60lbfgs%60%20solver%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Blr_model%5D%2C%20%22model__C%22%3A%20%5B0.01%2C0.1%2C1%2C10%5D%2C%20%22model__penalty%22%3A%5B%22l2%22%5D%2C%20%22model__solver%22%3A%5B%22lbfgs%22%5D%2C%0A%20%20%20%20%20%20%20%20%22dimen%22%3A%20%5B%22passthrough%22%5D%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20%23%20XGBoost%2C%20PCA%20On%0A%20%20%20%20%20%20%20%20%22dimen%22%3A%20%5Bpca%5D%2C%20%22dimen__n_components%22%3A%20np.arange(5%2C8%2C1)%2C%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Bxgb_model%5D%2C%20%22model__n_estimators%22%20%3A%20np.linspace(500%2C1100%2C3%2Cdtype%3Dint)%2C%22model__learning_rate%22%3A%20%5B0.01%2C0.1%5D%2C%20%22model__max_depth%22%3Anp.arange(7%2C14%2C3)%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20%23%20XGBoost%2C%20LDA%20On%0A%20%20%20%20%20%20%20%20%22dimen%22%3A%20%5Blda%5D%2C%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Bxgb_model%5D%2C%20%22model__n_estimators%22%20%3A%20%5B500%2C700%2C900%5D%2C%22model__learning_rate%22%3A%20%5B0.01%2C0.1%5D%2C%20%22model__max_depth%22%3Anp.arange(7%2C14%2C3)%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%7B%20%23%20XGBoost%2C%20No%20dimen.%20reduction%0A%20%20%20%20%20%20%20%20%22dimen%22%3A%20%5B%22passthrough%22%5D%2C%0A%20%20%20%20%20%20%20%20%22model%22%3A%20%5Bxgb_model%5D%2C%20%22model__n_estimators%22%20%3A%20%5B500%2C700%2C900%5D%2C%22model__learning_rate%22%3A%20%5B0.01%2C0.1%5D%2C%20%22model__max_depth%22%3Anp.arange(7%2C14%2C3)%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%5D%0A%0A%20%20%20%20rscv%20%3D%20RandomizedSearchCV(%0A%20%20%20%20%20%20estimator%3Dpipe%2Cparam_distributions%3Dparam_list%2Cn_iter%3D8%2Ccv%3D5%2Cn_jobs%3D-1%2Crandom_state%3D50%2Crefit%3DTrue%0A%20%20%20%20)%0A%0A%20%20%20%20rscv.fit(x_train%2Cy_train)%0A%20%20%20%20estimator%20%3D%20rscv.best_estimator_%0A%20%20%20%20score%20%3D%20rscv.best_score_%0A%20%20%20%20config%20%3D%20rscv.best_params_%0A%20%20%20%20print(f%22Best%20Configuration%3A%5Cn%7Bconfig%7D%22)%0A%20%20%20%20print(f%22Best%20Score%20%3D%20%7Bscore%7D%22)%0A%20%20%20%20return%20(rscv%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Now%2C%20let's%20calculate%20the%20**Classification%20Report**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(classification_report%2C%20rscv%2C%20x_test%2C%20y_test)%3A%0A%20%20%20%20y_true%20%3D%20y_test%0A%20%20%20%20y_pred%20%3D%20rscv.predict(x_test)%0A%20%20%20%20print(classification_report(y_true%3Dy_true%2Cy_pred%3Dy_pred))%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20As%20we%20can%20see%2C%20the%20overall%20accuracy%20decreased%20about%201%25%20from%20before.%20But%20it%20is%20a%20huge%20win%20considering%20the%20simplicity%20we%20have%20successfully%20added%20by%20performing%20the%20feature%20reduction.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Summary%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20In%20this%20notebook%2C%20we%20have%20explored%20how%20we%20can%20make%20the%20model%20suitable%20for%20user%20usage%20by%20reducing%20the%20number%20of%20features.%20We%20have%20seen%20that%20it%20has%20made%20the%20model%20a%20lot%20simplier%20by%20only%20sacrificing%201%25%20accuracy.%0A%0A%20%20%20%20We%20will%20use%20the%20code%20from%20this%20notebook%20to%20write%20%60fit.py%60%20from%20the%20ground%20up.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">94e1f0e0e2a35c0e7670cebc7b0ddd0a</marimo-code-hash>
</body>
</html>
